apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: github-dashboard-ingress
  namespace: github-dashboard
  labels:
    app: github-dashboard
    'internal:operations:Environment': 'development'
    'internal:operations:Owner': 'DevOps'
    'internal:compliance:Framework': 'HIPAA'
    'internal:cost-allocation:Application': 'github-dashboard'
    'internal:cost-allocation:Client': 'internal'
  annotations:
    # ALB annotations
    kubernetes.io/ingress.class: 'alb'
    alb.ingress.kubernetes.io/scheme: 'internal'
    alb.ingress.kubernetes.io/target-type: 'ip'
    alb.ingress.kubernetes.io/listen-ports: '[{"HTTP": 80}, {"HTTPS": 443}]'
    alb.ingress.kubernetes.io/ssl-redirect: '443'
    alb.ingress.kubernetes.io/healthcheck-path: '/health'
    alb.ingress.kubernetes.io/healthcheck-port: '3001'
    alb.ingress.kubernetes.io/healthcheck-protocol: 'HTTP'
    alb.ingress.kubernetes.io/success-codes: '200,302'
    alb.ingress.kubernetes.io/load-balancer-attributes: 'deletion_protection.enabled=false,idle_timeout.timeout_seconds=60'
    alb.ingress.kubernetes.io/tags: 'Environment=development,Owner=DevOps,Compliance=HIPAA'
spec:
  ingressClassName: alb
  rules:
  - host: github-dashboard.dev.joinchorus.com
    http:
      paths:
      - path: /api
        pathType: Prefix
        backend:
          service:
            name: github-dashboard-api-service
            port:
              number: 80
      - path: /
        pathType: Prefix
        backend:
          service:
            name: github-dashboard-web-service
            port:
              number: 80
